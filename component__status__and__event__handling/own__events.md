# Собственные события

Следующим логичным шагом будет сделать так что бы мы смогли удалять элементы из списка.

Но с этой функциональностью не все так просто. Дело в том что в react компонент не может просто так взять и самоудалиться. Для того что бы удалить элемент. Нам нужно удалить его из источника данных.

![](../img/component__status__and__event__handling/own__events/001.jpg)

А источник данных для наших **todo-list-item** если вы помните находите в **app.js**. Bvtyyj туда мы вынесли наш массив который содержит данные по тем элементам которые мы добавляем


![](../img/component__status__and__event__handling/own__events/002.jpg)

Как же нам реализовать удаление? 
Давайте перед тем как мы перейдем к коду разберем эту идею на примере схемы.

И так вот схематически изображено наше приложение.


![](../img/component__status__and__event__handling/own__events/003.jpg)

На самом верхнем уровне у нас находится компонент **App** и именно в этом компоненте находится наш **todoDate** тот массив который мы используем для всех компонентов ниже


![](../img/component__status__and__event__handling/own__events/004.jpg)

Следом идут несколько компонентов которые мы пока что не используем. И в конце у нас есть **< TodoList>** у которого в свою очередь есть **< TodoListItem>** и у которого есть кнопка **Button** которая удаляет элементы.


![](../img/component__status__and__event__handling/own__events/005.jpg)


Для того что бы избавиться от этого элемента внизу иерархии


![](../img/component__status__and__event__handling/own__events/006.jpg)

Нам нужно сделать так что бы данные вверху иерархии на уровне **App** обновились. Другими словами нам нужно сделать так что бы компонент **App** каким-то образом узнавил что кнопка на компоненте **TodoListItem** была нажата. 

И мы можем это сделать. Передать в верх по иерархии данные используя свою собственную систему событий. Идея которую мы сейчас реализуем заключается в том что **TodoListItem** будет генерить события которое будет слушать **TodoList**
. **TodoList** передаст это событие еще выше в элемент **App**


![](../img/component__status__and__event__handling/own__events/007.jpg)

И элемент **App** в Свою очередь обновит массив. Затем после того как массив обновится TodoListItem исчезнет потому что соответствующего элемента в массиве не будет.


![](../img/component__status__and__event__handling/own__events/008.jpg)

А теперь когда у нас есть план давайте вернемся к нашему коду и попробуем этот план реализовать.

Сперва заходим в файл **todo-list.js**


![](../img/component__status__and__event__handling/own__events/009.jpg)

И мы передадим каждому компоненту, кждому TodoListItem, каждому нашему элементу 


![](../img/component__status__and__event__handling/own__events/010.jpg)

мы передадим еще одну функцию вместе со всеми **itemProps** которые мы уже передаем

![](../img/component__status__and__event__handling/own__events/011.jpg)

И сюда же мы передатим еще одно свойство в котором будет функция. ***Точно так же как мы поступали когда мы регестрировали event lisener,слушатель событий в переводе, для DOM event , DOM событий***

Но в этом случае у нас будет **custom event, пользовательское событие.** Назовем его **onDeleted** и врутрь мы передадим функцию

![](../img/component__status__and__event__handling/own__events/012.jpg)

![](../img/component__status__and__event__handling/own__events/013.jpg)

теперь у нас появилось новое свойство и внутри TodoListItem мы сможем вызвать эту самую функцию каждый раз когда пользователь будет нажимать на кнопку удаления.
Это мы были в **todo-list-js**. Возвращаемся в **todo-list-item.js** и подумаем как мы это сделаем. Нам нужна вот эта кнопка.

![](../img/component__status__and__event__handling/own__events/014.jpg)


**fa-trash-o**-это иконка мусорной карзины.
Давайте добавим к этой кнопке еще один event lisener, пользовательское событие, **onClick={}**,поскольку мы реагируем на клик. И когда пользователь нажимает на эту кнопку мы вызовем функцию котораю нам передели в **props** из элемента выше **this.props.onDeleted**

![](../img/component__status__and__event__handling/own__events/015.jpg)

Давайте проверим что этот код работает. Если мы все написали правильно, то когда мы нажмем на кнопку у нас появится в консоли сообщение **deleted**.

![](../img/component__status__and__event__handling/own__events/016.jpg)

Соответственно мы создали эту первую связь между нашим **TodoListItem** одним элементом нашего списка и **Todolist**

![](../img/component__status__and__event__handling/own__events/017.jpg)

Наш **TodoListItem** говорит **TodoList** пользователь решил меня удалить. Сделай что-нибудь по этому поводу.

Отлично первый шаг сделан!!!!

Вохвращаемся в todo-list-item.js и сделаем этот код немного лучше. В место того что бы писать **this.props** мы деструктурируем т.к. мы делаем со всеми остальными свойствами. Мы деструктурируем это значение из **this.props** в начале функции 

![](../img/component__status__and__event__handling/own__events/018.jpg)

И просто подставляем ее на место

![](../img/component__status__and__event__handling/own__events/019.jpg)


Теперь заходим в todo-list.js.
Мы не хотим просто писать **console.log('Deleted')**

![](../img/component__status__and__event__handling/own__events/020.jpg)

Мы хотим передать это сообщение еще на один уровень выше т.е. на уровень компонента **App**. Но в случае с **App** нам не достаточно передать что какой-то некий элемент из списка решил удалиться. Нам нужно передать какой именно это был элемент. 

Заходим в app.js и смотрим как будет выглядеть event lisener (слушатель событий) с этой стороны.

![](../img/component__status__and__event__handling/own__events/021.jpg)

Создаем **event lisener** (нового пользовательского слушателя событий)
**onDeleted = ({})** и этот event lisener будет получать **id** элемента корого мы удаляем. Пишем console.log для того что бы убедится что мы получаем правильный id.

![](../img/component__status__and__event__handling/own__events/022.jpg)

Переходим в **todo-list.js**  и убедимся что мы действительно вызываем эту функци.

И так TodoList это у нас обычный функциональный компонент. Вот его props **todos**

![](../img/component__status__and__event__handling/own__events/023.jpg)

Пока что мы получаем толко todos, но теперь нам нужно получать и **onDeleted**

![](../img/component__status__and__event__handling/own__events/024.jpg)

**onDeleted** это та функция которую мы получаем сверху из **App**. 
B теперь это удаляем и вызываем эту функцию.

![](../img/component__status__and__event__handling/own__events/025.jpg)

И теперь в event lisener (пользовательском слушателе) просто вызываем эту функцию и в параметрах не забываем что нам нужно передать id  того самого элемента которого мы удаляем.

![](../img/component__status__and__event__handling/own__events/026.jpg)

После сохранения проверяем работает ли наш код.

![](../img/component__status__and__event__handling/own__events/027.jpg)

Соответственно теперь наш **app.js** знает что один из элементов удалился.

*Следующим шагом будет удалить этот элемент из массива и обновить приложение*.

Но прямо сейчас сделать мы это не сможем поскольку наш массив **todoDate** не часть состояния, не часть state компонента **App**.

Если видите наш компонент App это просто функция

![](../img/component__status__and__event__handling/own__events/028.jpg)

Нам впервую очередь нам нужно будет сделать так что бы **todoDate** стал частью состояния этого компонента. Ну а сам компонент **App**
стал **class** и мы это сделаем в следующем видио.

![](../img/component__status__and__event__handling/own__events/029.jpg)

Повторим что мы сделали и как работает наше кастомное событие. Тут даже кастомной системы событий нет. Все что мы делаем мы передаем в функции в нашем компоненте

![](../img/component__status__and__event__handling/own__events/030.jpg)

а затем, когда происходит одно из событий DOM, мы вызываем эти функции

![](../img/component__status__and__event__handling/own__events/031.jpg)

т.е. мы говорим, передаем выше по иерархии компонентов информацию о том что-то произошло. Например компонент удалился. И таким образом когда мы кликаем на кнопку в TodoListItem

![](../img/component__status__and__event__handling/own__events/032.jpg)

мы вызываем функцию которая нам передал TodoList. 

![](../img/component__status__and__event__handling/own__events/033.jpg)

TodoList в свою очередь вызывает функцию которую передал ему App. Таким обоазом App узнает о том что 1-н из TodoListItem решил удалиться.

Ntgthm когда мы отрефакторим App. Состояние App изменится и соответственно один из TodoListItem будет удален.

![](../img/component__status__and__event__handling/own__events/034.jpg)


